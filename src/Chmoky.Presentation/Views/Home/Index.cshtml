@{
    ViewBag.Title = "Godel Heroes: Top 10";
}

<hr />

<div class="table-responsive">
    <div class="fixed-table-toolbar">
        <div class="bars pull-left">
            <div id="header-toolbar">
                <button type="button" class="btn btn-default " id="next">Next</button>
                <button type="button" class="btn btn-primary " id="current">Current</button>
                <button type="button" class="btn btn-default " id="previous">Previous</button>
            </div>
        </div>
    </div>
    <table class="table"
            id="top10"
            data-toggle="table"
            data-url="/Home/GetTop10"
            data-query-params="postQueryParams"
            data-method="post"
            data-content-type="application/x-www-form-urlencoded"
            data-side-pagination="server"
            data-pagination="true"
            data-page-size="10"
            data-page-list="[10, 20, 50, 100, 200]"
            data-sort-order="desc"
            data-sort-name="total_just_text">
        <colgroup span="4"></colgroup>
        <colgroup span="2"></colgroup>
        <colgroup span="3"></colgroup>
        <thead>
            <tr>
                <th data-field="FirstName">First Name</th>
                <th data-field="LastName">Last Name</th>
                <th data-field="DispName">Skype Name</th>
                <th data-field="author">Skype ID</th>
                <th data-field="count" data-sortable="true">Messages Count</th>
                <th data-field="total_just_text" data-sortable="true">Total Text Length</th>
                <th data-field="min_just_text" data-sortable="true">Message Length Min</th>
                <th data-field="max_just_text" data-sortable="true">Message Length Max</th>
                <th data-field="avg_just_text" data-sortable="true">Message Length Avg</th>
            </tr>
        </thead>
    </table>
</div>

            @section scripts
{
                <script src="/Scripts/date.js"></script>

                <script>
                    function getCaptionFromDate(date) {
                        return shortMonthNames[date.getMonth()] + " " + date.getFullYear();
                    }

                    function changeButtonsCaptions() {
                        $('#current').html("Statistics for " + getCaptionFromDate(currentDate));

                        $('#previous').html(getCaptionFromDate(new Date(currentDate).add(-1).month()));

                        $('#next').html(getCaptionFromDate(new Date(currentDate).add(1).month()));
                    }

                    var shortMonthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                        "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                    ];

                    var monthNames = ["January", "February", "March", "April", "May", "June",
                        "July", "August", "September", "October", "November", "December"
                    ];

                    var currentDate = Date.today().add(-1).month();

                    changeButtonsCaptions();

                    function postQueryParams(params) {
                        params.currentDate = currentDate.toJSON();
                        return params;
                    }

                    $('#previous').click(function () {
                        currentDate = new Date(currentDate).add(-1).month();
                        $('#top10').bootstrapTable('refresh');
                        changeButtonsCaptions();
                    });

                    $('#next').click(function () {
                        currentDate = new Date(currentDate).add(1).month();
                        $('#top10').bootstrapTable('refresh');
                        changeButtonsCaptions();
                    });
                </script>
            }
